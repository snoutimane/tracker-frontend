<div class="container">
  <app-dashboard></app-dashboard>
  <h2>View Candidate</h2>

  <div class="input-group mb-3">
    <input type="text" class="form-control py-2 border-right-0" [(ngModel)]="searchText" placeholder="Search Candidates" (input)="onSearchTextChange()" />
    <div class="input-group-append">
      <button class="btn btn-outline-secondary border-left-0" (click)="clearSearch()">
        <i class="fas fa-times"></i> Clear
      </button>
    </div>
  </div>

  <table class="table">
    <thead>
      <tr>
        <th>Emp Id</th>
        <th>Emp Name</th>
        <th class="sticky-column">E-mail</th>
        <th>Project Name</th>
        <th>Project Code</th>
        <th>Project Manager</th>
        <th>Project Location</th>
        <th>Interviewed</th>
        <th>Interview Date</th>
        <th>Feedback</th>
        <th>Feedback Description</th>
        <th>Comments</th>
        <th>Feedback Attachment</th>
        <th>Proposed Date</th>
        <th>Mentor Name</th>
        <th>Status</th>
        <th>Edit/Delete</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let candidate of filteredCandidates">
        <td (dblclick)="editCell(candidate)">
          <span *ngIf="!candidate.isEditing">{{ candidate.empId }}</span>
          <input
            *ngIf="candidate.isEditing"
            [(ngModel)]="editedValue"
            (blur)="saveEditedValue(candidate)"
          />
        </td>
        <td>{{candidate.employeeName}}</td>
        <td class="sticky-column">{{ candidate.email }}</td>
        <td>{{ candidate.projectName }}</td>
        <td>{{ candidate.projectCode }}</td>
        <td>{{ candidate.projectManager }}</td>
        <td>{{ candidate.projectLocation }}</td>
        <td>{{ candidate.interviewed }}</td>
        <td>{{ candidate.interviewDate }}</td>
        <td>{{ candidate.feedback }}</td>
        <td>{{ candidate.feedbackDescription }}</td>
        <td>{{ candidate.comment }}</td>
        <td>
          <!-- Display the attachment button only if there is an attachment -->
          <button *ngIf="candidate.image" class="view-attachment-button" (click)="openAttachmentModal(candidate.image)">
            Open
          </button>
        </td>
        <td>{{ candidate.proposedDate }}</td>
        <td>{{ candidate.mentorName }}</td>
       
        <td>{{ candidate.status }}</td>
        <td>
          <button class="edit-button" (click)="openEditDialog()">Edit</button>
          <button id="delete" (click)="deleteCandidate(candidate)">Delete</button>
        </td>
      </tr>
    </tbody>
  </table>
</div>

<div class="modal" tabindex="-1" role="dialog" [ngClass]="{'show': showAttachmentModal}" [style.display]="showAttachmentModal ? 'block' : 'none'">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Attachment</h5>
        <button type="button" class="close" (click)="closeAttachment()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <!-- Display the selected attachment (iframe, image, or other content) -->
        <iframe [src]="selectedAttachment" width="100%" height="500px"></iframe>
      </div>
    </div>
  </div>
</div>

<!-- Background overlay when the modal is open -->
<div class="modal-backdrop fade" [class.show]="showAttachmentModal"></div>
